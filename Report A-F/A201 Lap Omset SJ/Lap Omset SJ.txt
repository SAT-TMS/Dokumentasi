Laporan Omset SJ (Header)
1. Form Load
	- Jika LocationIDLog = L10001
		-- LocationName = " "
	- Jika LocationIDLog != L10001
		-- LocationName = LocationIDLog
	- Jika jumlah baris tabel LokasiDs > 0
		-- Clear semua baris
	- LokasiDs = Get data dari LocationList
	- CboLokasi
		-- Source = LokasiDs
		-- Value Input = LocationID
		-- Text Display = LocationName
	- Set default CboLaporan = A201-Omset Surat Jalan (pilihan paling atas)
	- Set default CboBarang = All (pilihan paling atas)
	- Set default CboFormatExcel = Format Font (pilihan paling atas)
2. TxtCustomer, Customer
3. TxtSales, Sales
4. TxtProject, Project
5. TxtKontrak, Kontrak
6. BtnClearCustomer
	- TxtCustomer = " " (kosong)
7. BtnClearSales
	- TxtSales = " " (kosong)
8. BtnClearProject
	- TxtProject = " " (kosong)
9. BtnClearKontrak
	- TxtKontrak = " " (kosong)
10. SearchButton Customer
	- Membuka Searching Form
		-- Grid Customer, Sales, Project dan Kontrak
		-- TextBox Input : Customer, Sales, Project, dan Kontrak
		-- Memilih data dari grid
	- Input data yang dipilih dimasukkan ke dalam TxtCustomer, TxtSales, TxtProject, TxtKontrak
11. CustomerCheckBox
	- Jika CustomerCheckBox dicek
		-- TxtCustomer.Text = %
        - Jika CustomerCheckBox tidak dicek
		-- TxtCustomer.Text = " " (kosong)
12. SalesCheckBox
	- Jika SalesCheckBox dicek
		-- TxtSales.Text = %
        - Jika SalesCheckBox tidak dicek
		-- TxtSales.Text = " " (kosong)
13. ProjectCheckBox
	- Jika ProjectCheckBox dicek
		-- TxtProject.Text = %
        - Jika ProjectCheckBox tidak dicek
		-- TxtProject.Text = " " (kosong)
14. KontrakCheckBox
	- Jika KontrakCheckBox dicek
		-- TxtKontrak.Text = %
        - Jika KontrakCheckBox tidak dicek
		-- TxtKontrak.Text = " " (kosong)
15. CboLokasi
	- CboLokasi = sesuai LocationID dan LocationName
16. txtDateFrom, Tanggal Laporan Omset SJ
17. txtDateTo, Tanggal Selesai Laporan Omset SJ
18. CboLaporan
	- A201-Omset Surat Jalan
19. CboBarang
	- All
	- 50 Billet
	- 51 Besi Beton
	- 52 Wire Rod
	- 53 Wire Mesh
	- 54 Kanal
	- 55 PC Wire
	- 56 Wire Mesh Kg
	- 57 PC Strand
	- 58 Lain-lain
	- 59 BBS
	- 60 MLO
	- 61 Rebar
	- 62 BIC
	- 63 CLO
	- 64 Kloss
	- 65 Drawn Wire
	- 66 Millscale
	- 67 Scrap
	- 68 PIC
	- 69 Spool
20. CboFormatExcel
	- Format Font
	- Minimalis
21. DataGridView1
	- TanggalPO	
	- NomorPO	
	- PickSlipID	
	- NomorPOCust	
	- ProjectName	
	- ProductID	
	- KodeMarketing	
	- QuantityPO	
	- SatuanPO	
	- TanggalSJ	
	- SuratJalanID	
	- Memo	
	- NoMobil	
	- QuantitySJ	
	- SatuanSJ	
	- WPS	
	- BeratNettoStd	
	- Tarra	
	- Brutto	
	- Netto	
	- Sisa	
	- DPP	
	- Total	
	- PPN	
	- Jumlah	
	- BasicOngkos	
	- ExpedisiName	
	- TglTerimaSj	
	- TanggalNota	
	- NomorNota	
	- TglKirim_Inv	
	- NomorKontrak	
	- NamaCustomer	
	- Penjual	
	- LocationName	
	- F/L	
	- Jenis	
	- Currency	
	- Kurs	
	- DPP_Ori	
	- DPPRp	
	- PPN_IDR	
	- Jumlah_IDR
22. MenuClick
	- MnuRefresh
		-- Memanggil Function DataSheet
			--- Jika CboBarang tidak dipilih 
            			---- Keluar dari A201FrmRptOmset
        		--- Jika CboLaporan.Text = " " (kosong)
            			---- Keluar dari A201FrmRptOmset
        		--- Jika CboLaporan != " " (kosong)
            			---- LblLaporan = CboLaporan
            			---- Jika CboLaporan = "A201-Omset Surat Jalan"
                			----- Jika TxtCustomer != " "
                    				------ Supl_Name = TxtCustomer
                			----- Jika TxtCustomer = " "
                    				------ Supl_Name = "%"
                			----- Jika TxtSales != " "
                    				------ Sales = TxtSales
                			----- Jika TxtSales = " "
                    				------ Sales = "%"
                			----- Jika CboLokasi = "LAIN LAIN"
                    				------ LocationName = "%"
                			----- Jika CboLokasi != "LAIN-LAIN"
                    				------ LocationName = CboLokasi
                			----- Jika TxtProject != " "
                    				------ Project = TxtProject
                			----- Jika TxtProject = " "
                    				------ Project = "%"
                			----- Jika TxtKontrak != " "
                    				------ NomorKontrak = TxtKontrak
                			----- Jika TxtKontrak = " "
                    				------ NomorKontrak = "%"
                			----- DateFrom = txtDateFrom
                			----- DateTo = txtDateTo
                			----- Jika CboBarang = "All"
                    				------ Jenis = "%"
                			----- Jika CboBarang != "All"
                    				------ Jenis = CboBarang
				---- Jika jumlah baris dalam table > 0
					----- Clear semua baris
				---- Jika CboLaporan = "A201-Omset Surat Jalan"
					----- data = Database Service Report_A201_Omset_Surat_Jalan
				---- Jika jumlah baris dalam table = 0
					----- MessageBox = "Data Tidak Ada !!!"
				---- Jika jumlah baris dalam table > 0
					----- DataGridView = data
					----- Format tanggal = dd MM yyyy
						------ d = Tanggal
						------ M = Bulan
						------ y = Tahun
					----- TotalBarisLabel6 = jumlah baris
				---- Jika jumlah baris dalam table = 0
					----- TotalBarisLabel6 = 0
	- MnuExport
		-- Jika CboLaporan = " " (kosong)
			--- Keluar dari A201FrmRptOmset
		-- Jika CboLaporan != " "
			--- Jika LblLaporan != CboLaporan
				---- Memanggil MnuRefresh
			--- Jika CboFormatExcel = FormatFont
				---- Dari DataGridView1 = Report_A201_Omset_Surat_Jalan
					----- Memanggil Tabel
						------ Supl_Name
						------ Sales
						------ LocationName
						------ ProjectName
						------ NomorKontrak
						------ DateFrom
						------ DateTo
						------ jenis
					----- Kondisi Table
						------ Supl_Name	= '%PT. INTAN PERTIWI INDUSTRI%'--'PT. WIJAYA KARYA (PERSERO), TBK'r
						------ Sales 		= '%'
						------ LocationName 	= '%'
						------ ProjectName 	= '%'--'LRT JAKARTA KORIDOR 1 (PHASE 1) KELAPAGADING-VELODROME'
						------ NomorKontrak 	= '%'--'TP.01.03/A.PS.3524/2017..'
						------ DateFrom 	= '26 apr 2021'
						------ DateTo 		= '26 apr 2021'
						------ jenis 		= '%'--'51 Besi Beton'
					----- FROM Report@_Master_LPM
						------ Currency = IDR
					----- FROM Report@_Master_LPM
						------ NomorKontrak	= NomorKontrak
						------ Penjual		= Sales 
						------ NamaCustomer	= Supl_Name 
						------ ProjectName	= ProjectName 
						------ locationname	= LocationName
						------ cast(convert(varchar,cast(Outs as datetime),106)as datetime) between @DateFrom and @DateTo
						------ JenisBarang	= jenis
						------ ProjectName = %NGEPOK%' AND NomorPO = '%N%' AND HargaBasic = 0
						------ NomorPO = '%TL%' OR HargaBasic = 500
						------ SuratJalanID 	= '19/MS3/SJ00006994','19/MS3/SJ00007674','19/MS3/SJ00007559',
									  '19/MS3/SJ00007564','19/MS3/SJ00010582'
						------ UNION ALL
					----- FROM Report@_Master_LPM
						------ NomorKontrak	= NomorKontrak
						------ Penjual		= Sales 
						------ NamaCustomer	= Supl_Name 
						------ ProjectName	= ProjectName 
						------ locationname	= LocationName
						------ cast(convert(varchar, cast(Outs as datetime),106) as datetime) between DateFrom and DateTo
						------ JenisBarang	= jenis
						------ ProjectName = %NGEPOK%' AND NomorPO = '%N%' AND HargaBasic = 0
						------ NomorPO = '%TL%' OR HargaBasic = 500
						------ SuratJalanID 	= '19/MS3/SJ00006994','19/MS3/SJ00007674','19/MS3/SJ00007559',
									  '19/MS3/SJ00007564','19/MS3/SJ00010582'
						------ GROUP BY NomorPO
						------ ORDER BY NomorPO, mark, NamaBarang, QuantityPO desc, cast(TanggalSJ as datetime), SuratJalanID, ProductID
					----- FROM _Report_A201_Omset_Surat_Jalan_Result
						------ POID (Trx_PickSlip) = POID (Trx_PO) 
						------ on SupplierID (Trx_PO) = Supl_ID (MS_Supplier) 
						------ GROUP BY PickSlipID (Trx_PickSlip) , JenisPerusahaan (MS_Supplier)
						------ ON PickSlipID (_Report_A201_Omset_Surat_Jalan_Result) = PickSlipID (Trx_PickSlip) 
						------ SuratJalanID = '18/MS3/SJ00018613'
						------ NomorPO = '%TL%' OR NomorPO = '%N%' OR HargaRp=500 OR ProjectName = '%NGEPOK%'
						------ ORDER BY ids
			--- Jika CboFormatExcel = Minimalis
				---- Get data dari Report_A201_Omset_Surat_Jalan_Summary
					----- Memanggil Tabel
						------ Supl_Name
						------ Sales
						------ LocationName
						------ ProjectName
						------ NomorKontrak
						------ DateFrom
						------ DateTo
						------ jenis
					----- Kondisi Tabel
						------ Supl_Name = '%%'--'PT. WIJAYA KARYA (PERSERO), TBK'
						------ Sales = '%'
						------ LocationName = '%'
						------ ProjectName = '%'--'LRT JAKARTA KORIDOR 1 (PHASE 1) KELAPAGADING-VELODROME'
						------ NomorKontrak = '%'--'TP.01.03/A.PS.3524/2017..'
						------ DateFrom = '9-jun-2017'
						------ DateTo = '9-jun-2017'
						------ jenis = '51 Besi Beton'
					----- Jika SatuanSJ != 'kg' 
						------ FORMAT(SUM(QuantitySJ),'N0') + ' ' + SatuanSJ
					----- Jika SatuanSJ = 'kg'
						------ FORMAT(SUM(BeratNettoStd),'N0') + ' ' + SatuanSJ
					----- Jika (max(jenisbarang) IN ('52 Wire Rod') AND max(wps) <= 1)
						------ SUM(Netto)
					----- Jika (max(jenisbarang) NOT IN ('52 Wire Rod') AND max(wps) !<= 1)
						------ SUM(Quantity2)
					----- Jika SatuanSJ != 'kg'
						------ SUM(QuantitySJ)
					----- Jika SatuanSJ = 'kg'
						------ SUM(BeratNettoStd)
					----- DPP = SUM(Total)
					----- PPNR = SUM(ppn)
					----- JumlahR = SUM(Total) + SUM(ppn) 
					----- JumlahR = SUM(jumlah)
					----- FROM Report@_Master_LPM
						------ NomorKontrak 	= NomorKontrak 
						------ Penjual 		= Sales 
						------ NamaCustomer 	= Supl_Name 
						------ ProjectName 	= ProjectName 
						------ locationname 	= '%' + LocationName + '%' 
						------ cast(convert(varchar, cast(Outs as datetime), 106) as datetime) between DateFrom AND DateTo 
						------ JenisBarang 	= jenis 
						------ ProjectName != '%NGEPOK%' AND NomorPO != '%N%' AND HargaBasic != 0
						------ NomorPO != '%TL%' OR HargaBasic != 500)
						------ GROUP BY ProductID, NamaBarang, HargaBasic, SatuanSJ 
	- MnuExit
		-- Keluar dari A201FrmRptOmset
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 